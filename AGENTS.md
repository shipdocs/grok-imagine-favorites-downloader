# Repository Guidelines

## Project Structure & Module Organization
- Chrome extension lives in `extension/`. The service worker logic sits in `background.js`, the in-page side panel UI is delivered by `panel.js`/`panel.css`, and metadata stays in `manifest.json`.
- Store reusable UI fragments or icons inside `extension/assets/` (create it if missing) to keep the root uncluttered. Keep documentation like this guide at the repository root.

## Build, Test, and Development Commands
- Load the unpacked extension through `chrome://extensions`, enable **Developer mode**, and choose the `extension/` directory; Chrome hot-reloads files as you save them.
- Open `https://grok.com/imagine/favorites`, solve any prompts, click the extension icon to open the right-hand panel, then press **Start Download**; the progress bar should reflect the total media count and climb as files finish.
- Use `chrome://extensions/?errors=extension` for runtime logs and `chrome://downloads/` to confirm downloads land inside the timestamped `grok-favorites/<datetime>/` folders.

## Coding Style & Naming Conventions
- JavaScript follows modern Chrome standards: 2-space indentation, `const`/`let`, arrow functions for inline callbacks, and early returns for guard clauses.
- Keep helper functions pure where possible (`notify`, `prepareQueue`, `deriveBaseName`) and surface user-facing status through `notify()` so the panel stays informative; sync history updates through `sendStatus()`.
- Use kebab-case for assets, camelCase for locals, and descriptive set-based filenames generated by `buildFilename()`—image/video pairs share the same stem while their extension differs.

## Testing Guidelines
- Run manual smoketests after changes: trigger a download run, watch the side panel progress bar increment, and review Chrome’s download shelf for both images and videos inside the session folder.
- Enable the panel’s debug checkbox when diagnosing scroll or pagination issues; the status log will emit detailed metrics to confirm favorites are loading.
- When tweaking DOM selectors in `scrapeFavorites()`, verify against live favorites and note fallback behaviour (e.g., missing posters) in PR descriptions.
- Capture console output from the active tab (`DevTools > Console`) when diagnosing missing assets; include key findings in review notes and update grouping heuristics when DOM changes.

## Commit & Pull Request Guidelines
- Write imperative, ~65-character subjects (e.g., `Streamline download queue handling`) and keep functional changes and documentation updates separated when practical.
- Summarise manual verification (page visited, progress observed, files created) in each PR, and attach screenshots/GIFs for side panel UI or progress bar changes.
- Link related issues or support tickets so reviewers understand user impact and any follow-up items.

## Security & Configuration Tips
- Avoid logging full asset URLs; rely on the built-in `truncate()` helper to keep identifiers readable without leaking user IDs.
- Keep personal Grok credentials, cookies, or exported download folders outside the repo and add them to `.gitignore` if needed.
